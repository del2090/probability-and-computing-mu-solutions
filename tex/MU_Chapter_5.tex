\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{amsmath}
\usepackage{amssymb}

\title {Probability and Computing, 2nd Edition \\[2ex] \large Solutions to Chapter 5: Balls, Bins, and Random Graphs}
\author{Hahndeul Kim}
\date{July 2025}

\begin{document}

\maketitle
\newpage
\section*{5.1}
As $(1+1/n)^n$ increases, we find the smallest $n$ to reach the threshold.\\
$(1+1/n)^n$ first reaches $0.99e$ at $n=50$, and $0.999999e$ at $n=499982$.\\
Since $(1-1/n)^n$ also increases, we solve in a similar way. $(1-1/n)^n$ first reaches $0.99/e$ at $n=51$ and $0.999999/e$ at $n=499991$.
\section*{5.2}
Recall the formula used in the birthday paradox: If there are $N$ possibilities, then we solve for the smallest $n$ that satisfies
$\prod\limits_{i=1}^{n-1}(1-\frac{i}{N})\approx\prod\limits_{i=1}^{n-1}e^{-i/n}=e^{-(n-1)n/2N}<1/2$.
Note that we omitted the final approximation to derive exact numerical answers.\\
Regardless of whether the number of Social Security number digits is $9$ or $13$, using the last four digits gives $N=10000$ and this gives $n=119$.\\
In the case where the number of digits is $9$ ($N=10^9$), we get $n=37234$.\\
In the case where the number of digits is $13$ ($N=10^{13}$), we get $n=3723298$.
\section*{5.3}
Let the number of balls thrown be $m$. Then the desired probability is $\prod\limits_{i=0}^{m-1}(1-\frac{i}{n})$.\\
We first determine $c_1$.
$m=c_1\sqrt{n}$ should satisfy $\prod\limits_{i=0}^{m-1}(1-\frac{i}{n}) \leq \prod\limits_{i=0}^{m-1}e^{-i/n}=e^{-(m-1)m/2n}\leq e^{-1}$.
Since $(m-1)m=c_1^2n-c_1\sqrt{n}\geq 2n$, $(c_1^2-2)\sqrt{n}\geq c_1$.
Therefore, we choose $c_1$ that is greater than or equal to $\frac{1}{2}\left(\frac{1}{\sqrt{n}}+\sqrt{\frac{1}{n}+8}\right)$.\\
Now we determine $c_2$. To use the given hint, assume that $2m < n$.\\
$\prod\limits_{i=0}^{m-1}(1-\frac{i}{n})\geq\prod\limits_{i=0}^{m-1}\exp(-\frac{i}{n}-\frac{i^2}{n^2})=\exp(-\frac{m(m-1)}{2n}-\frac{(m-1)m(2m-1)}{6n^2})$\\
$=\exp(-\frac{m(m-1)}{2n}(1+\frac{2m-1}{3n}))\geq\exp(-\frac{m^2}{2n}(1+\frac{2m}{3n}))\geq \frac{1}{2}$ should be satisfied for $m=c_2\sqrt{n}$.
This is equivalent to satisfying $\frac{c_2^2}{2}(1+\frac{2c_2}{3\sqrt{n}})\leq \ln 2$.\\
Since $n$ is sufficiently large, choosing $c_2 = \sqrt{2\ln2 - \frac{1}{\ln n}}$ yields the desired result.
\section*{5.4}

\end{document}